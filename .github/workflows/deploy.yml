name: Deploy to GitHub Pages
 
on:
 push:
   branches: [ master ]
 pull_request:
   branches: [ master ]

jobs:
 build-and-deploy:
   environment: Email
   runs-on: ubuntu-latest
   
   steps:
   - name: Checkout
     uses: actions/checkout@v3
     
   - name: Setup Node.js
     uses: actions/setup-node@v4
     with:
       node-version: '20'
       cache: 'npm'
       
   - name: Install dependencies
     run: npm ci
     
   - name: Build
     run: npm run build
     env:
       VITE_EMAILJS_SERVICE_ID: ${{ secrets.VITE_EMAILJS_SERVICE_ID }}
       VITE_EMAILJS_TEMPLATE_ID: ${{ secrets.VITE_EMAILJS_TEMPLATE_ID }}
       VITE_EMAILJS_PUBLIC_KEY: ${{ secrets.VITE_EMAILJS_PUBLIC_KEY }}
       
   - name: Deploy to GitHub Pages
     uses: peaceiris/actions-gh-pages@v3
     if: github.ref == 'refs/heads/master'
     with:
       github_token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
       publish_dir: ./dist
